<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/docs/4.0/assets/img/favicons/favicon.ico">

    <title>{{ items['dataset1']['data']['reportTitle'] }}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" 
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    
    <style>
        @page {
            size: A4;
            margin: 0;
        }
      
        @media print and (color) {
            * {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            body {
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }

            h3 {
                margin-top: 2rem;
            }

            [class*="col-"] {
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }        

            hr {
                margin-top: 2rem;
                margin-bottom: 2rem;
            }
            .sheet {
                margin: 2rem;
            }
            .report-heading {
                font-size: 0.6rem;
            }
            .compliance-assessment {
                font-size: 0.6rem;
            }
            .compliance-title {
                font-size: 0.5rem;
                color: darkslategray;
                font-weight: bold;
            }
            .compliance-severity {
                font-size: 0.7rem;
                text-align: center;
            }
            .compliance-severity-count {
                font-size: 1.5rem;
                text-align: center;
            }
            .dot-critical {
                height: 7px;
                width: 7px;
                background-color:crimson;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-high {
                height: 7px;
                width: 7px;
                background-color:red;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-medium {
                height: 7px;
                width: 7px;
                background-color:orange;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-low {
                height: 7px;
                width: 7px;
                background-color:yellow;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-info {
                height: 7px;
                width: 7px;
                background-color:cornflowerblue;
                border-radius: 50%;
                display: inline-block;
            }
            .box-border {
                border:darkgrey 1px solid;
                padding: 10px;
            }
            article {
                margin-top: 10px;
                border: lightgray 1px solid;
                padding: 10px;
            }
            table {
                width: 100%;
            }
            thead {
                background-color: lightgray;
                font-size: 0.8em;
                font-weight: bold;
            }
            td {
                padding: 5px;
                font-size: 0.75em;
            }
        }

        @media screen {
            body {
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }

            h3 {
                margin-top: 2rem;
            }

            [class*="col-"] {
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }        

            hr {
                margin-top: 2rem;
                margin-bottom: 2rem;
            }
            .sheet {
                margin: 2rem;
            }
            .report-heading {
                font-size: 0.6rem;
            }
            .compliance-assessment {
                font-size: 0.6rem;
            }
            .compliance-title {
                font-size: 0.5rem;
                color: darkslategray;
                font-weight: bold;
            }
            .compliance-severity {
                font-size: 0.7rem;
                text-align: center;
            }
            .compliance-severity-count {
                font-size: 1.5rem;
                text-align: center;
            }
            .dot-critical {
                height: 7px;
                width: 7px;
                background-color:crimson;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-high {
                height: 7px;
                width: 7px;
                background-color:red;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-medium {
                height: 7px;
                width: 7px;
                background-color:orange;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-low {
                height: 7px;
                width: 7px;
                background-color:yellow;
                border-radius: 50%;
                display: inline-block;
            }
            .dot-info {
                height: 7px;
                width: 7px;
                background-color:cornflowerblue;
                border-radius: 50%;
                display: inline-block;
            }
            .box-border {
                border:darkgrey 1px solid;
                padding: 10px;
            }
            article {
                margin-top: 10px;
                border: lightgray 1px solid;
                padding: 10px;
            }
            table {
                width: 100%;
            }
            thead {
                background-color: lightgray;
                font-size: 0.8em;
                font-weight: bold;
            }
            td {
                padding: 5px;
                font-size: 0.75em;
            }
        }
    </style>
</head>

<body>
    <section class="sheet">
        <div class="row">
            <div class="col-sm-4"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIxLjEuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCAxNTAwIDQyNyIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMTUwMCA0Mjc7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojMDBBRUVGO30KCS5zdDF7ZmlsbDojODA4ODhGO30KPC9zdHlsZT4KPGc+Cgk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMzM4LDkzLjRjMC0yLjktMi4xLTUuMy00LjktNS43SDEwOS45Yy0yLjgsMC40LTQuOSwyLjgtNC45LDUuN3YxMTguOWMwLDEzLjYsMiwyNi41LDYuNSwzOC40bDIyNi41LTEyN1Y5My40CgkJeiIvPgoJPHBhdGggY2xhc3M9InN0MCIgZD0iTTIyMS41LDM0My4zYzI5LDAsMTE2LjMtNTIuOSwxMTYuMy0xMzAuOXYtNDAuMmwtMjI1LDgzLjJDMTM0LjYsMzA3LjYsMTk3LjcsMzQzLjMsMjIxLjUsMzQzLjMiLz4KPC9nPgo8cG9seWdvbiBjbGFzcz0ic3QxIiBwb2ludHM9IjQxNi41LDEzMi43IDQ0OC4yLDEzMi43IDQ0OC4yLDI1My4yIDUwNy44LDI1My4yIDUwNy44LDI4MS4yIDQxNi41LDI4MS4yICIvPgo8Zz4KCTxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik01OTguOSwyMjcuOGMwLTE2LjQtMTMuNy0yNy40LTI3LjYtMjcuNGMtMTUuMSwwLTI3LjYsMTEuNi0yNy42LDI3LjRjMCwxNS41LDEyLjYsMjcuNiwyNy42LDI3LjYKCQlDNTg1LjksMjU1LjQsNTk4LjksMjQ0LDU5OC45LDIyNy44IE02MjkuNywxNzQuOXYxMDYuNGgtMjkuOVYyNjhjLTcuNSwxMC41LTIyLjQsMTUuMy0zNC4yLDE1LjNjLTI3LjQsMC01Mi4zLTIxLjItNTIuMy01NS41CgkJczI0LjktNTUuNSw1Mi4zLTU1LjVjMTIuMywwLDI2LjcsNC42LDM0LjIsMTUuM3YtMTIuOGgyOS45VjE3NC45eiIvPgoJPHBhdGggY2xhc3M9InN0MSIgZD0iTTY0My4xLDIyNy42YzAtMzMuOCwyNy40LTU1LjUsNTguNC01NS41YzE5LjQsMCwzNC45LDkuMSw0NSwyMi44bC0yMi40LDE1LjdjLTQuOC02LjYtMTMuNy0xMC43LTIyLjQtMTAuNwoJCWMtMTYuOSwwLTI4LjMsMTIuMS0yOC4zLDI3LjZjMCwxNS43LDExLjQsMjcuOSwyOC4zLDI3LjljOC43LDAsMTcuNi00LjEsMjIuNC0xMC43bDIyLjQsMTUuN2MtMTAsMTMuOS0yNS42LDIyLjgtNDUsMjIuOAoJCUM2NzAuNSwyODMuMyw2NDMuMSwyNjEuNCw2NDMuMSwyMjcuNiIvPgoJPHBhdGggY2xhc3M9InN0MSIgZD0iTTgzNS44LDIxOC4yYy0wLjktMTIuNi0xMS40LTIwLjEtMjQuOS0yMC4xYy0xMi4xLDAtMjIuOCw1LjctMjYsMjAuMUg4MzUuOHogTTg2NS4zLDIzNy42aC04MC40CgkJYzMuMiwxMi4zLDEzLjIsMTkuMiwyNy42LDE5LjJjMTAuNywwLDIxLjUtNC4zLDI3LjktMTEuOWwxNy42LDE3LjZjLTEwLDEzLjUtMjguOCwyMC44LTQ3LjUsMjAuOGMtMzIuNiwwLTU2LjYtMjIuNC01Ni42LTU1LjIKCQljMC0zNC41LDI2LTU1LjksNTYuNi01NS45YzMwLjQsMCw1NS4yLDIxLjUsNTUuMiw1NC4xQzg2NS43LDIyOS4yLDg2NS41LDIzMi44LDg2NS4zLDIzNy42Ii8+CjwvZz4KPHBvbHlnb24gY2xhc3M9InN0MSIgcG9pbnRzPSIxMDM4LjMsMTc0LjkgMTAwMC42LDI4MS4yIDk3NS4xLDI4MS4yIDk1My4yLDIxMi4xIDkzMS45LDI4MS4yIDkwNi40LDI4MS4yIDg2Ny41LDE3NC45IDkwMCwxNzQuOSAKCTkyMCwyMzkuNyA5NDAuNCwxNzQuOSA5NjUuNSwxNzQuOSA5ODUuOCwyMzkuNyAxMDA1LjksMTc0LjkgIi8+CjxnPgoJPHBhdGggY2xhc3M9InN0MSIgZD0iTTExMjAuOSwyMjcuOGMwLTE2LjctMTIuMS0yNy45LTI2LjktMjcuOXMtMjYuOSwxMS4yLTI2LjksMjcuOWMwLDE2LjQsMTIuMSwyNy42LDI2LjksMjcuNgoJCUMxMTA4LjgsMjU1LjQsMTEyMC45LDI0NC4zLDExMjAuOSwyMjcuOCBNMTAzNi42LDIyNy44YzAtMzMuOCwyNi45LTU1LjcsNTcuMy01NS43czU3LjMsMjEuOSw1Ny4zLDU1LjcKCQljMCwzMy42LTI2LjksNTUuNS01Ny4zLDU1LjVTMTAzNi42LDI2MS40LDEwMzYuNiwyMjcuOCIvPgoJPHBhdGggY2xhc3M9InN0MSIgZD0iTTEyNDIuNSwxNzUuNWwtNi45LDI4LjVjLTYuNC0zLjQtMTEuNi0zLjktMTUuMy0zLjljLTE1LjMsMC0yNS44LDE0LjItMjUuOCw0NC41djM2LjVoLTI5LjlWMTc0LjloMjkuN3YyMi42CgkJYzUuOS0xNy44LDE4LTI1LjMsMzEuMy0yNS4zQzEyMzEuMywxNzIuMSwxMjM3LjcsMTczLDEyNDIuNSwxNzUuNSIvPgo8L2c+Cjxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMTMyMi41LDI4MS4yIDEyODUuMSwyMzUuMSAxMjg1LjEsMjgxLjIgMTI1NS4yLDI4MS4yIDEyNTUuMiwxMjYuOCAxMjg1LjEsMTI2LjggMTI4NS4xLDIwNy4zIAoJMTMxMiwxNzQuOSAxMzUwLjQsMTc0LjkgMTMwOC44LDIyMS43IDEzNTkuOCwyODEuMiAiLz4KPHBvbHlnb24gY2xhc3M9InN0MSIgcG9pbnRzPSIxMzYyLjIsMTI4LjYgMTM1Ni42LDEyOC42IDEzNTYuNiwxNDQuMiAxMzU0LjIsMTQ0LjIgMTM1NC4yLDEyOC42IDEzNDguNiwxMjguNiAxMzQ4LjYsMTI2LjggCgkxMzYyLjIsMTI2LjggIi8+Cjxwb2x5Z29uIGNsYXNzPSJzdDEiIHBvaW50cz0iMTM3OSwxMjYuOCAxMzczLjQsMTQxIDEzNzMuMywxNDEgMTM2Ny44LDEyNi44IDEzNjQuOCwxMjYuOCAxMzY0LjgsMTQ0LjIgMTM2Ny4xLDE0NC4yIDEzNjcuMSwxMzcuMyAKCTEzNjYuOSwxMzAuMyAxMzY3LDEzMC4zIDEzNzIuNiwxNDQuMiAxMzc0LjIsMTQ0LjIgMTM3OS44LDEzMC4yIDEzNzkuOSwxMzAuMiAxMzc5LjYsMTM3LjMgMTM3OS42LDE0NC4yIDEzODIsMTQ0LjIgMTM4MiwxMjYuOCAiLz4KPC9zdmc+Cg==" title="Lacework icon" class="logo-icon" alt=""></div>
            <div class="col-sm-8">&nbsp;</div>
        </div>
        <!-- Write HTML just like a web page -->
        <article>
            <div class="row">
                <div class="col-12">
                    <strong>{{ items['dataset1']['data']['reportTitle'] }}</strong>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-3 report-heading"><strong>REPORT TYPE</strong></br>
                    {{ items['dataset1']['data']['reportTitle'] }}</div>
                <div class="col-sm-3 report-heading"><strong>ORGANIZATION</strong></br>
                   {{ items['dataset1']['data']['organizationName'] }} ({{ items['dataset1']['data']['organizationId'] }})</div>
                <div class="col-sm-3 report-heading"><strong>PROJECT</strong></br>
                    {{ items['dataset1']['data']['projectName'] }} ({{ items['dataset1']['data']['projectId'] }})</div>
                <div class="col-sm-3 report-heading"><strong>REPORT TIME</strong></br>
                    {{ items['dataset1']['data']['reportTime'] }}</div>
            </div>
            <div class="row">
                <div class="col-sm-6">
                    <div class="box-border">
                        <div class="row">
                            <div class="col-1 compliance-severity">&nbsp;</div>
                            <div class="col-2 compliance-severity-count">{{ items['dataset1']['data']['summary'][0]['num_severity_1_non_compliance'] }}</div>
                            <div class="col-2 compliance-severity-count">{{ items['dataset1']['data']['summary'][0]['num_severity_2_non_compliance'] }}</div>
                            <div class="col-2 compliance-severity-count">{{ items['dataset1']['data']['summary'][0]['num_severity_3_non_compliance'] }}</div>
                            <div class="col-2 compliance-severity-count">{{ items['dataset1']['data']['summary'][0]['num_severity_4_non_compliance'] }}</div>
                            <div class="col-2 compliance-severity-count">{{ items['dataset1']['data']['summary'][0]['num_severity_5_non_compliance'] }}</div>
                            <div class="col-1 compliance-severity">&nbsp;</div>
                        </div>
                        <div class="row">
                            <div class="col-1 compliance-severity">&nbsp;</div>
                            <div class="col-2 compliance-severity">critical</div>
                            <div class="col-2 compliance-severity">high</div>
                            <div class="col-2 compliance-severity">medium</div>
                            <div class="col-2 compliance-severity">low</div>
                            <div class="col-2 compliance-severity">info</div>
                            <div class="col-1 compliance-severity">&nbsp;</div>
                        </div>
                        <div class="row">
                            <div class="col-1 compliance-severity">&nbsp;</div>
                            <div class="col-2 compliance-severity"><span class="dot-critical"></span></div>
                            <div class="col-2 compliance-severity"><span class="dot-high"></span></div>
                            <div class="col-2 compliance-severity"><span class="dot-medium"></span></div>
                            <div class="col-2 compliance-severity"><span class="dot-low"></span></div>
                            <div class="col-2 compliance-severity"><span class="dot-info"></span></div>
                            <div class="col-1 compliance-severity">&nbsp;</div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="box-border">
                        <div class="row">
                            <div class="col-12 compliance-title">Non-Compliant</br>Recommendations</div>
                        </div>
                        <div class="row">
                            <div class="col-4 compliance-severity-count">{{ items['dataset1']['data']['summary'][0]['num_not_compliant'] }}</div>
                            {% set total_assessed = items['dataset1']['data']['summary'][0]['num_not_compliant']|int + items['dataset1']['data']['summary'][0]['num_compliant']|int %}
                            <div class="col-8 compliance-assessment">{{ total_assessed }} Assessed</br>{{ items['dataset1']['data']['summary'][0]['num_suppressed'] }} Suppressed</br></div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="box-border">
                        <div class="row">
                            <div class="col-12 compliance-title">Non-Compliant</br>Resources</div>
                        </div>
                        <div class="row">
                            <div class="col-4 compliance-severity-count">{{ items['dataset1']['data']['summary'][0]['violated_resource_count'] }}</div>
                            <div class="col-8 compliance-assessment">{{ items['dataset1']['data']['summary'][0]['assessed_resource_count'] }} Assessed</br>{{ items['dataset1']['data']['summary'][0]['suppressed_resource_count'] }} Suppressed</div>
                        </div>
                        <div class="row"></div>
                    </div>
                </div>
            </div>
        </article>
        {% set categories = [] %}
        {% for r in items['dataset1']['data']['recommendations'] if r['category'] not in categories %}
            {% do categories.append(r['category']) %}
        {% endfor %}
        {% for c in categories %}
        <article>
            <div class="row">
                <div class="col-12">{{ c }}</div>
            </div>
            <div class="row">
                <div class="col-12">
                    <table>
                        <thead>
                            <td>id</td>
                            <td>recommendation</td>
                            <td>status</td>
                            <td>severity</td>
                            <td>affected</td>
                            <td>assessed</td>
                        </thead>
                        {% for r in items['dataset1']['data']['recommendations'] if r['category'] == c %}
                        <tr>
                            <td><a href="{{ r['info_link'] }}" target="_blank" rel="noopener noreferrer">{{ r['rec_id'] }}</a></td>
                            <td>{{ r['title'] }}</td>
                            <td>{{ r['status'] }}</td>
                            <td>{{ r['severity'] }}</td>
                            <td>{{ r['resource_count'] }}</td>
                            <td>{{ r['assessed_resource_count'] }}</td>
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </article>
        {% endfor %}
    </section>
</body>

</html>